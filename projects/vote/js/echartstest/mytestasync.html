<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ECharts Test</title>
    <script src="echarts.min.js"></script>

</head>
<body>
    <div id="main" style="width: 1000px;height:600px;"></div>
    <div id="user" style="width: 1000px;height:600px;"></div>
    <div id="fate" style="width: 1000px;height:600px;"></div>
    <div id="country" style="width: 1000px;height:600px;"></div>
    <!-- <script src="ajax.js"></script> -->
    <script type="text/javascript">
        // 初始 option
        option = {
            title: {
                text: ''
            },
            tooltip: {},
            legend: {
                data:['销量']
            },
            xAxis: {
                data: [],
                axisLabel: {
                   interval:0,
                   rotate:40
                }
            },
            yAxis: {
            },
            series: [{
                name: '销量',
                type: 'bar',
                data: [],
                //begin
                itemStyle: {
                    normal:{
                        // color:function(d){return "#"+Math.floor(Math.random()*(256*256*256-1)).toString(16);}
                        color: function (params){
                            // var colorList = ['rgb(205,85,85)','rgb(210,105,30)','rgb(0,139,0)','rgb(178,58,238)','rgb(54,100,139)'];
                            var colorList = ['#C33531','#EFE42A','#64BD3D','#EE9201','#29AAE3', '#B74AE5','#0AAF9F','#E89589','#16A085','#4A235A','#C39BD3 ','#F9E79F','#BA4A00','#ECF0F1','#616A6B','#EAF2F8','#4A235A','#3498DB' ];
                            return colorList[params.dataIndex%colorList.length];
                        }
                    },
                    //鼠标悬停时：
                    emphasis: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }]
        };

        function Ajax(url, title, x, y, echartsInstance) {
            if(window.XMLHttpRequest) {
                var oAjax = new XMLHttpRequest();// code for IE7+, Firefox, Chrome, Opera, Safari
            }
            else {
                var oAjax = new ActiveXObject("Microsoft.XMLHTTP");// code for IE6, IE5
            }
            try {
                oAjax.open('GET', url, true);//open(方法，文件名，异步传输)
                oAjax.send();
            }
            catch (err) {
                console.log("err:" + err);
            }
            oAjax.onreadystatechange = function() {
                if (oAjax.readyState == 4) {
                    if(oAjax.status == 200) {
                        var gameData = oAjax.responseText.split("\n");
                        var xAxis = new Array()
                        var dataAxis = new Array();
                        for (var i = 1; i < gameData.length - 1; i++) {
                            console.log(gameData[i]);
                            var arr = gameData[i].split(",");
                            xAxis[i-1] = arr[x];
                            dataAxis[i-1] = arr[y];
                        }

                        echartsInstance.setOption({
                            title: {
                                text: title
                            },
                            xAxis: {
                                data: xAxis
                            },
                            series: [{
                                name: '邀请数',
                                data: dataAxis
                            }]
                        });
                    }
                    else {
                        console.log("status:" + oAjax.status);
                    }
                };
            };
        }

        var myChart = echarts.init(document.getElementById('main'));
        myChart.setOption(option);
        Ajax('data.csv', 'User Trend', 1, 3, myChart);

        var userChart = echarts.init(document.getElementById('user'));
        userChart.setOption(option);
        Ajax('country.csv', 'User Trend', 0, 1, userChart);


    </script>
</body>
</html>